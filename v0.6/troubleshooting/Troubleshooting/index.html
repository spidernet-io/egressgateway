
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://spidernet-io.github.io/egressgateway/v0.6/troubleshooting/Troubleshooting/">
      
      
        <link rel="prev" href="../../develop/Roadmap/">
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.2, mkdocs-material-9.2.8">
    
    
      
        <title>Troubleshooting - EgressGateway</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.046329b4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.85d0ee34.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="#4478D1" data-md-color-accent="indigo">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#troubleshooting-guide" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="EgressGateway" class="md-header__button md-logo" aria-label="EgressGateway" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            EgressGateway
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Troubleshooting
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
      <div class="md-header__option">
  <div class="md-select">
    
    <button class="md-header__button md-icon" aria-label="Select language">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12.87 15.07-2.54-2.51.03-.03A17.52 17.52 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04M18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12m-2.62 7 1.62-4.33L19.12 17h-3.24Z"/></svg>
    </button>
    <div class="md-select__inner">
      <ul class="md-select__list">
        
          <li class="md-select__item">
            <a href="./" hreflang="en" class="md-select__link">
              English
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="../../zh/troubleshooting/Troubleshooting/" hreflang="zh" class="md-select__link">
              中文
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</div>
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/spidernet-io/egressgateway" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    spidernet-io/egressgateway
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="EgressGateway" class="md-nav__button md-logo" aria-label="EgressGateway" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    EgressGateway
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/spidernet-io/egressgateway" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    spidernet-io/egressgateway
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Getting started
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Getting started
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../usage/Install/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Install
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../usage/Upgrade/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Upgrade
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../usage/Uninstall/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Uninstall
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Usage
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Usage
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../usage/NamespaceDefaultEgressGateway/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Namespace Default EgressGateway
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../usage/ClusterDefaultEgressGateway/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cluster Default EgressGateway
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../usage/EgressGatewayFailover/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Failover
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../usage/MoveIP/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Move EgressIP
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../usage/Aliyun/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Run EgressGateway on Aliyun Cloud
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../usage/AwsWithCilium/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Run EgressGateway on AWS Cloud
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../usage/Troubleshooting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Troubleshooting
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Concepts
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Concepts
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/Architecture/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Architecture
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/Datapath/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Datapath
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Reference
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/EgressTunnel/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CRD EgressTunnel
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/EgressGateway/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CRD EgressGateway
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/EgressPolicy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CRD EgressPolicy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/EgressClusterPolicy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CRD EgressClusterPolicy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/EgressEndpointSlice/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CRD EgressEndpointSlice
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/EgressClusterEndpointSlice/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CRD EgressClusterEndpointSlice
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/EgressClusterInfo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CRD EgressClusterInfo
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/egctl/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    egctl cli
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/metrics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    metrics
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Development
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Development
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../develop/Dataflow/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DataFlow
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../develop/Contribute/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contribute
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../develop/Release/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Release
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Community
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Community
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../develop/Roadmap/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Roadmap
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Troubleshooting
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Troubleshooting
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-ensure-components-are-running" class="md-nav__link">
    1. Ensure Components Are Running
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-check-calico-cni-configuration" class="md-nav__link">
    2. Check Calico CNI Configuration
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-check-egressgateway-tunnel-configuration" class="md-nav__link">
    3. Check EgressGateway Tunnel Configuration
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-check-egresspolicy-rules" class="md-nav__link">
    4. Check EgressPolicy Rules
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-check-if-the-egress-node-can-access-the-destsubnet-network" class="md-nav__link">
    5. Check if the Egress Node Can Access the destSubnet Network
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-packet-capture-check" class="md-nav__link">
    6. Packet Capture Check
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-ensure-components-are-running" class="md-nav__link">
    1. Ensure Components Are Running
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-check-calico-cni-configuration" class="md-nav__link">
    2. Check Calico CNI Configuration
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-check-egressgateway-tunnel-configuration" class="md-nav__link">
    3. Check EgressGateway Tunnel Configuration
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-check-egresspolicy-rules" class="md-nav__link">
    4. Check EgressPolicy Rules
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-check-if-the-egress-node-can-access-the-destsubnet-network" class="md-nav__link">
    5. Check if the Egress Node Can Access the destSubnet Network
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-packet-capture-check" class="md-nav__link">
    6. Packet Capture Check
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="troubleshooting-guide">Troubleshooting Guide</h1>
<h2 id="1-ensure-components-are-running">1. Ensure Components Are Running</h2>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>kubectl<span class="w"> </span>get<span class="w"> </span>pods<span class="w"> </span>-n<span class="w"> </span>kube-system<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-i<span class="w"> </span>egress
</span></code></pre></div>
<p>Run this command to check if all egress Pods are in the Running state. If any Pod is not Running, it may be due to the following reasons:</p>
<ul>
<li>Image Pull Back Off: Check the Pod description to confirm if there is an ImagePullBackOff error.</li>
<li>Pod Restart: Check the Pod restart count to see if any Pod is restarting frequently.</li>
</ul>
<h2 id="2-check-calico-cni-configuration">2. Check Calico CNI Configuration</h2>
<p>If you are using Calico CNI, follow this step. If you are using another CNI, skip this step. Ensure that Calico's chainInsertMode is set to Append. You can check this with the following command:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>kubectl<span class="w"> </span>get<span class="w"> </span>FelixConfiguration<span class="w"> </span>-n<span class="w"> </span>kube-system<span class="w"> </span>default<span class="w"> </span>-o<span class="w"> </span>yaml<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>chainInsertMode
</span></code></pre></div>
<p>If the output is not <code>Append</code> or the field is missing, you can modify it with:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>kubectl<span class="w"> </span>patch<span class="w"> </span>FelixConfiguration<span class="w"> </span>-n<span class="w"> </span>kube-system<span class="w"> </span>default<span class="w"> </span>--type<span class="o">=</span><span class="s1">&#39;json&#39;</span><span class="w"> </span>-p<span class="o">=</span><span class="s1">&#39;[{&quot;op&quot;: &quot;replace&quot;, &quot;path&quot;: &quot;/spec/chainInsertMode&quot;, &quot;value&quot;: &quot;Append&quot;}]&#39;</span>
</span></code></pre></div>
<p>This determines whether EgressGateway's iptables rules will be overridden by Calico. You can verify this directly on the host with:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>iptables<span class="w"> </span>-t<span class="w"> </span>mangle<span class="w"> </span>-nvL<span class="w"> </span>PREROUTING
</span></code></pre></div>
<p>If the first rule starts with <code>cali-*</code>, it means Calico's rules have overridden EgressGateway's rules.</p>
<p>Normally, you should see the following rules at the top:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>$<span class="w"> </span>iptables<span class="w"> </span>-t<span class="w"> </span>mangle<span class="w"> </span>-nvL<span class="w"> </span>PREROUTING
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>Chain<span class="w"> </span>PREROUTING<span class="w"> </span><span class="o">(</span>policy<span class="w"> </span>ACCEPT<span class="w"> </span><span class="m">0</span><span class="w"> </span>packets,<span class="w"> </span><span class="m">0</span><span class="w"> </span>bytes<span class="o">)</span>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="w"> </span>pkts<span class="w"> </span>bytes<span class="w"> </span>target<span class="w">                      </span>prot<span class="w"> </span>opt<span class="w"> </span><span class="k">in</span><span class="w">     </span>out<span class="w">     </span><span class="nb">source</span><span class="w">        </span>destination
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="w">    </span><span class="m">6</span><span class="w">    </span>6K<span class="w"> </span>EGRESSGATEWAY-MARK-REQUEST<span class="w">  </span><span class="m">0</span><span class="w">    </span>--<span class="w">  </span>*<span class="w">      </span>*<span class="w">       </span><span class="m">0</span>.0.0.0/0<span class="w">     </span><span class="m">0</span>.0.0.0/0<span class="w">     </span>/*<span class="w"> </span>egw:Lh98b3mb9WlZrgw7<span class="w"> </span>*/<span class="w"> </span>/*<span class="w"> </span>Checking<span class="w"> </span><span class="k">for</span><span class="w"> </span>EgressPolicy<span class="w"> </span>matched<span class="w"> </span>traffic<span class="w"> </span>*/
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a><span class="w">    </span><span class="m">0</span><span class="w">     </span><span class="m">0</span><span class="w"> </span>ACCEPT<span class="w">                      </span><span class="m">0</span><span class="w">    </span>--<span class="w">  </span>*<span class="w">      </span>*<span class="w">       </span><span class="m">0</span>.0.0.0/0<span class="w">     </span><span class="m">0</span>.0.0.0/0<span class="w">     </span>/*<span class="w"> </span>egw:4vaggeYl6c-Gn0Yv<span class="w"> </span>*/<span class="w"> </span>/*<span class="w"> </span>EgressGateway<span class="w"> </span>traffic<span class="w"> </span>accept<span class="w"> </span>datapath<span class="w"> </span>rule<span class="w"> </span>*/<span class="w"> </span>mark<span class="w"> </span>match<span class="w"> </span>0x26000000/0xff000000
</span></code></pre></div>
<h2 id="3-check-egressgateway-tunnel-configuration">3. Check EgressGateway Tunnel Configuration</h2>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>$<span class="w"> </span>kubectl<span class="w"> </span>get<span class="w"> </span>egt
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>NAME<span class="w">    </span>TUNNELMAC<span class="w">           </span>TUNNELIPV4<span class="w">       </span>TUNNELIPV6<span class="w">   </span>MARK<span class="w">         </span>PHASE
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a>node1<span class="w">   </span><span class="m">66</span>:c5:d6:cc:29:54<span class="w">   </span><span class="m">192</span>.200.142.89<span class="w">                </span>0x2698ee37<span class="w">   </span>Ready
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a>node2<span class="w">   </span><span class="m">66</span>:66:41:3e:23:6b<span class="w">   </span><span class="m">192</span>.200.201.40<span class="w">                </span>0x26b7b4e4<span class="w">   </span>Ready
</span></code></pre></div>
<p>You can see the TUNNELIPV4 address of each EgressGateway node. Try pinging these addresses to confirm they are reachable.</p>
<p>If the TUNNEL IP addresses are unreachable, possible reasons include:</p>
<ul>
<li>Network connectivity issues between nodes: Check the network connection between nodes to ensure they can ping each other.</li>
<li>Use <code>ip a show egress.vxlan</code> to check if the EgressGateway VXLAN interface exists and is UP or UNKNOWN. If it is DOWN, the VXLAN interface may not have been created correctly.</li>
</ul>
<h2 id="4-check-egresspolicy-rules">4. Check EgressPolicy Rules</h2>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>$<span class="w"> </span>kubectl<span class="w"> </span>get<span class="w"> </span>egresspolicy<span class="w"> </span>-A
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>NAMESPACE<span class="w">   </span>NAME<span class="w">   </span>GATEWAY<span class="w">   </span>IPV4<span class="w">            </span>IPV6<span class="w">   </span>EGRESSNODE
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>default<span class="w">     </span><span class="nb">test</span><span class="w">   </span>default<span class="w">   </span><span class="m">172</span>.16.25.189<span class="w">          </span>node2
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a>
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a>$<span class="w"> </span>kubectl<span class="w"> </span>get<span class="w"> </span>egresspolicy<span class="w"> </span><span class="nb">test</span><span class="w"> </span>-o<span class="w"> </span>yaml
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a>apiVersion:<span class="w"> </span>egressgateway.spidernet.io/v1beta1
</span><span id="__span-6-7"><a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a>kind:<span class="w"> </span>EgressPolicy
</span><span id="__span-6-8"><a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a>metadata:
</span><span id="__span-6-9"><a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a><span class="w">  </span>generation:<span class="w"> </span><span class="m">1</span>
</span><span id="__span-6-10"><a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a><span class="w">  </span>name:<span class="w"> </span><span class="nb">test</span>
</span><span id="__span-6-11"><a id="__codelineno-6-11" name="__codelineno-6-11" href="#__codelineno-6-11"></a><span class="w">  </span>namespace:<span class="w"> </span>default
</span><span id="__span-6-12"><a id="__codelineno-6-12" name="__codelineno-6-12" href="#__codelineno-6-12"></a>spec:
</span><span id="__span-6-13"><a id="__codelineno-6-13" name="__codelineno-6-13" href="#__codelineno-6-13"></a><span class="w">  </span>appliedTo:
</span><span id="__span-6-14"><a id="__codelineno-6-14" name="__codelineno-6-14" href="#__codelineno-6-14"></a><span class="w">    </span>podSelector:
</span><span id="__span-6-15"><a id="__codelineno-6-15" name="__codelineno-6-15" href="#__codelineno-6-15"></a><span class="w">      </span>matchLabels:
</span><span id="__span-6-16"><a id="__codelineno-6-16" name="__codelineno-6-16" href="#__codelineno-6-16"></a><span class="w">        </span>app:<span class="w"> </span>visitor
</span><span id="__span-6-17"><a id="__codelineno-6-17" name="__codelineno-6-17" href="#__codelineno-6-17"></a><span class="w">  </span>destSubnet:
</span><span id="__span-6-18"><a id="__codelineno-6-18" name="__codelineno-6-18" href="#__codelineno-6-18"></a><span class="w">  </span>-<span class="w"> </span><span class="m">172</span>.16.25.183/32
</span><span id="__span-6-19"><a id="__codelineno-6-19" name="__codelineno-6-19" href="#__codelineno-6-19"></a><span class="w">  </span>egressGatewayName:<span class="w"> </span>default
</span><span id="__span-6-20"><a id="__codelineno-6-20" name="__codelineno-6-20" href="#__codelineno-6-20"></a><span class="w">  </span>egressIP:
</span><span id="__span-6-21"><a id="__codelineno-6-21" name="__codelineno-6-21" href="#__codelineno-6-21"></a><span class="w">    </span>allocatorPolicy:<span class="w"> </span>default
</span><span id="__span-6-22"><a id="__codelineno-6-22" name="__codelineno-6-22" href="#__codelineno-6-22"></a><span class="w">    </span>useNodeIP:<span class="w"> </span><span class="nb">false</span>
</span><span id="__span-6-23"><a id="__codelineno-6-23" name="__codelineno-6-23" href="#__codelineno-6-23"></a>status:
</span><span id="__span-6-24"><a id="__codelineno-6-24" name="__codelineno-6-24" href="#__codelineno-6-24"></a><span class="w">  </span>eip:
</span><span id="__span-6-25"><a id="__codelineno-6-25" name="__codelineno-6-25" href="#__codelineno-6-25"></a><span class="w">    </span>ipv4:<span class="w"> </span><span class="m">172</span>.16.25.189
</span><span id="__span-6-26"><a id="__codelineno-6-26" name="__codelineno-6-26" href="#__codelineno-6-26"></a><span class="w">  </span>node:<span class="w"> </span>node2
</span></code></pre></div>
<p>Check the EgressPolicy configuration and ensure the following:</p>
<ul>
<li><code>spec.egressGatewayName</code> correctly specifies the EgressGateway name.</li>
<li><code>spec.appliedTo.podSelector</code> correctly matches the Pods that need to use the EgressPolicy.</li>
<li><code>spec.destSubnet</code> correctly specifies the destination subnet.</li>
<li><code>spec.egressIP</code> has allocated an egress IP address.</li>
</ul>
<p>You can check the ipset rules on the host where the Pod is located. If you do not have the ipset tool installed, install it with:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="c1"># Ubuntu/Debian</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>apt-get<span class="w"> </span>install<span class="w"> </span>ipset
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a>
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a><span class="c1"># CentOS / RHEL / Rocky Linux / AlmaLinux</span>
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a>yum<span class="w"> </span>install<span class="w"> </span>ipset
</span></code></pre></div>
<p>First, check the source IP rules for the EgressPolicy:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>$<span class="w"> </span>ipset<span class="w"> </span>list<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>egress-src-
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>Name:<span class="w"> </span>egress-src-v4-738bb014438bdbfe7
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a>
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a>$<span class="w"> </span>ipset<span class="w"> </span>list<span class="w"> </span>egress-src-v4-738bb014438bdbfe7
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a>Name:<span class="w"> </span>egress-src-v4-738bb014438bdbfe7
</span><span id="__span-8-6"><a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a>Type:<span class="w"> </span>hash:net
</span><span id="__span-8-7"><a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a>Revision:<span class="w"> </span><span class="m">7</span>
</span><span id="__span-8-8"><a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a>Header:<span class="w"> </span>family<span class="w"> </span>inet<span class="w"> </span>hashsize<span class="w"> </span><span class="m">1024</span><span class="w"> </span>maxelem<span class="w"> </span><span class="m">65536</span><span class="w"> </span>bucketsize<span class="w"> </span><span class="m">12</span><span class="w"> </span>initval<span class="w"> </span>0x498b6df2
</span><span id="__span-8-9"><a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a>Size<span class="w"> </span><span class="k">in</span><span class="w"> </span>memory:<span class="w"> </span><span class="m">504</span>
</span><span id="__span-8-10"><a id="__codelineno-8-10" name="__codelineno-8-10" href="#__codelineno-8-10"></a>References:<span class="w"> </span><span class="m">1</span>
</span><span id="__span-8-11"><a id="__codelineno-8-11" name="__codelineno-8-11" href="#__codelineno-8-11"></a>Number<span class="w"> </span>of<span class="w"> </span>entries:<span class="w"> </span><span class="m">1</span>
</span><span id="__span-8-12"><a id="__codelineno-8-12" name="__codelineno-8-12" href="#__codelineno-8-12"></a>Members:
</span><span id="__span-8-13"><a id="__codelineno-8-13" name="__codelineno-8-13" href="#__codelineno-8-13"></a><span class="m">10</span>.200.0.22
</span></code></pre></div>
<p>The above command lists all egress-src-* ipset rules. Check if the corresponding rule contains the Pod's IP address.</p>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>$<span class="w"> </span>ipset<span class="w"> </span>list<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>egress-dst-
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>Name:<span class="w"> </span>egress-dst-v4-738bb014438bdbfe7
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a>
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a>$<span class="w"> </span>ipset<span class="w"> </span>list<span class="w"> </span>egress-dst-v4-738bb014438bdbfe7
</span><span id="__span-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a>Name:<span class="w"> </span>egress-dst-v4-738bb014438bdbfe7
</span><span id="__span-9-6"><a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a>Type:<span class="w"> </span>hash:net
</span><span id="__span-9-7"><a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a>Revision:<span class="w"> </span><span class="m">7</span>
</span><span id="__span-9-8"><a id="__codelineno-9-8" name="__codelineno-9-8" href="#__codelineno-9-8"></a>Header:<span class="w"> </span>family<span class="w"> </span>inet<span class="w"> </span>hashsize<span class="w"> </span><span class="m">1024</span><span class="w"> </span>maxelem<span class="w"> </span><span class="m">65536</span><span class="w"> </span>bucketsize<span class="w"> </span><span class="m">12</span><span class="w"> </span>initval<span class="w"> </span>0x14fe6b9e
</span><span id="__span-9-9"><a id="__codelineno-9-9" name="__codelineno-9-9" href="#__codelineno-9-9"></a>Size<span class="w"> </span><span class="k">in</span><span class="w"> </span>memory:<span class="w"> </span><span class="m">504</span>
</span><span id="__span-9-10"><a id="__codelineno-9-10" name="__codelineno-9-10" href="#__codelineno-9-10"></a>References:<span class="w"> </span><span class="m">1</span>
</span><span id="__span-9-11"><a id="__codelineno-9-11" name="__codelineno-9-11" href="#__codelineno-9-11"></a>Number<span class="w"> </span>of<span class="w"> </span>entries:<span class="w"> </span><span class="m">1</span>
</span><span id="__span-9-12"><a id="__codelineno-9-12" name="__codelineno-9-12" href="#__codelineno-9-12"></a>Members:
</span><span id="__span-9-13"><a id="__codelineno-9-13" name="__codelineno-9-13" href="#__codelineno-9-13"></a><span class="m">172</span>.16.25.183
</span></code></pre></div>
<p>The above command lists all <code>egress-dst-*</code> ipset rules. Check if the corresponding rule contains the destination subnet's IP address.</p>
<p>If you cannot find the corresponding ipset rule, it may be because <code>spec.destSubnet</code> is not set in the EgressPolicy. In this case, EgressGateway will forward all traffic except for traffic within the Kubernetes cluster.</p>
<p>Matched traffic will be marked with a <code>0x26*</code> mark. You can check whether any traffic has been marked using the following command:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a>$<span class="w"> </span>iptables<span class="w"> </span>-t<span class="w"> </span>mangle<span class="w"> </span>-nvL<span class="w"> </span>PREROUTING
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a>Chain<span class="w"> </span>PREROUTING<span class="w"> </span><span class="o">(</span>policy<span class="w"> </span>ACCEPT<span class="w"> </span><span class="m">0</span><span class="w"> </span>packets,<span class="w"> </span><span class="m">0</span><span class="w"> </span>bytes<span class="o">)</span>
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a>pkts<span class="w"> </span>bytes<span class="w"> </span>target<span class="w">     </span>prot<span class="w"> </span>opt<span class="w"> </span><span class="k">in</span><span class="w">     </span>out<span class="w">     </span><span class="nb">source</span><span class="w">               </span>destination
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a>8395K<span class="w"> </span>1939M<span class="w"> </span>EGRESSGATEWAY-MARK-REQUEST<span class="w">  </span><span class="m">0</span><span class="w">    </span>--<span class="w">  </span>*<span class="w">      </span>*<span class="w">       </span><span class="m">0</span>.0.0.0/0<span class="w">            </span><span class="m">0</span>.0.0.0/0<span class="w">            </span>/*<span class="w"> </span>egw:Lh98b3mb9WlZrgw7<span class="w"> </span>*/<span class="w"> </span>/*<span class="w"> </span>Checking<span class="w"> </span><span class="k">for</span><span class="w"> </span>EgressPolicy<span class="w"> </span>matched<span class="w"> </span>traffic<span class="w"> </span>*/
</span><span id="__span-10-5"><a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a><span class="m">0</span><span class="w">         </span><span class="m">0</span><span class="w"> </span>ACCEPT<span class="w">     </span><span class="m">0</span><span class="w">    </span>--<span class="w">  </span>*<span class="w">      </span>*<span class="w">       </span><span class="m">0</span>.0.0.0/0<span class="w">            </span><span class="m">0</span>.0.0.0/0<span class="w">            </span>/*<span class="w"> </span>egw:4vaggeYl6c-Gn0Yv<span class="w"> </span>*/<span class="w"> </span>/*<span class="w"> </span>EgressGateway<span class="w"> </span>traffic<span class="w"> </span>accept<span class="w"> </span>datapath<span class="w"> </span>rule<span class="w"> </span>*/<span class="w"> </span>mark<span class="w"> </span>match<span class="w"> </span>0x26000000/0xff000000
</span><span id="__span-10-6"><a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a>
</span><span id="__span-10-7"><a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a>$<span class="w"> </span>iptables<span class="w"> </span>-t<span class="w"> </span>mangle<span class="w"> </span>-nvL<span class="w"> </span>EGRESSGATEWAY-MARK-REQUEST
</span><span id="__span-10-8"><a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a>Chain<span class="w"> </span>EGRESSGATEWAY-MARK-REQUEST<span class="w"> </span><span class="o">(</span><span class="m">1</span><span class="w"> </span>references<span class="o">)</span>
</span><span id="__span-10-9"><a id="__codelineno-10-9" name="__codelineno-10-9" href="#__codelineno-10-9"></a>pkts<span class="w"> </span>bytes<span class="w"> </span>target<span class="w">     </span>prot<span class="w"> </span>opt<span class="w"> </span><span class="k">in</span><span class="w">     </span>out<span class="w">     </span><span class="nb">source</span><span class="w">               </span>destination
</span><span id="__span-10-10"><a id="__codelineno-10-10" name="__codelineno-10-10" href="#__codelineno-10-10"></a><span class="m">0</span><span class="w">        </span><span class="m">0</span><span class="w"> </span>MARK<span class="w">       </span><span class="m">0</span><span class="w">    </span>--<span class="w">  </span>*<span class="w">      </span>*<span class="w">       </span><span class="m">0</span>.0.0.0/0<span class="w">            </span><span class="m">0</span>.0.0.0/0<span class="w">            </span>/*<span class="w"> </span>egw:c2Rxsf_p-hXQYsiG<span class="w"> </span>*/<span class="w"> </span>/*<span class="w"> </span>Set<span class="w"> </span>mark<span class="w"> </span><span class="k">for</span><span class="w"> </span>EgressPolicy<span class="w"> </span>default-test<span class="w"> </span>*/<span class="w"> </span>match-set<span class="w"> </span>egress-src-v4-738bb014438bdbfe7<span class="w"> </span>src<span class="w"> </span>match-set<span class="w"> </span>egress-dst-v4-738bb014438bdbfe7<span class="w"> </span>dst<span class="w"> </span>ctdir<span class="w"> </span>ORIGINAL<span class="w"> </span>MARK<span class="w"> </span><span class="nb">set</span><span class="w"> </span>0x26b7b4e4
</span><span id="__span-10-11"><a id="__codelineno-10-11" name="__codelineno-10-11" href="#__codelineno-10-11"></a>
</span><span id="__span-10-12"><a id="__codelineno-10-12" name="__codelineno-10-12" href="#__codelineno-10-12"></a>You<span class="w"> </span>can<span class="w"> </span>see<span class="w"> </span>here<span class="w"> </span>that<span class="w"> </span>traffic<span class="w"> </span>matching<span class="w"> </span>the<span class="w"> </span>ipsets<span class="w"> </span>egress-src-v4-738bb014438bdbfe7<span class="w"> </span>and<span class="w"> </span>egress-dst-v4-738bb014438bdbfe7<span class="w"> </span>is<span class="w"> </span>marked<span class="w"> </span>with<span class="w"> </span>0x26b7b4e4.
</span><span id="__span-10-13"><a id="__codelineno-10-13" name="__codelineno-10-13" href="#__codelineno-10-13"></a>
</span><span id="__span-10-14"><a id="__codelineno-10-14" name="__codelineno-10-14" href="#__codelineno-10-14"></a>$<span class="w"> </span>iptables<span class="w"> </span>-t<span class="w"> </span>nat<span class="w"> </span>-nvL<span class="w"> </span>POSTROUTING
</span><span id="__span-10-15"><a id="__codelineno-10-15" name="__codelineno-10-15" href="#__codelineno-10-15"></a>Chain<span class="w"> </span>POSTROUTING<span class="w"> </span><span class="o">(</span>policy<span class="w"> </span>ACCEPT<span class="w"> </span>155K<span class="w"> </span>packets,<span class="w"> </span>9365K<span class="w"> </span>bytes<span class="o">)</span>
</span><span id="__span-10-16"><a id="__codelineno-10-16" name="__codelineno-10-16" href="#__codelineno-10-16"></a>pkts<span class="w"> </span>bytes<span class="w"> </span>target<span class="w">                  </span>prot<span class="w"> </span>opt<span class="w"> </span><span class="k">in</span><span class="w">     </span>out<span class="w">       </span><span class="nb">source</span><span class="w">               </span>destination
</span><span id="__span-10-17"><a id="__codelineno-10-17" name="__codelineno-10-17" href="#__codelineno-10-17"></a>155K<span class="w"> </span>9361K<span class="w"> </span>EGRESSGATEWAY-SNAT-EIP<span class="w">  </span><span class="m">0</span><span class="w">    </span>--<span class="w">  </span>*<span class="w">      </span>*<span class="w">         </span><span class="m">0</span>.0.0.0/0<span class="w">            </span><span class="m">0</span>.0.0.0/0<span class="w">            </span>/*<span class="w"> </span>egw:x1tdBi75jif7GCxh<span class="w"> </span>*/<span class="w"> </span>/*<span class="w"> </span>SNAT<span class="w"> </span><span class="k">for</span><span class="w"> </span>egress<span class="w"> </span>traffic<span class="w"> </span>*/
</span><span id="__span-10-18"><a id="__codelineno-10-18" name="__codelineno-10-18" href="#__codelineno-10-18"></a><span class="m">0</span><span class="w">        </span><span class="m">0</span><span class="w"> </span>ACCEPT<span class="w">                  </span><span class="m">0</span><span class="w">    </span>--<span class="w">  </span>*<span class="w">      </span>*<span class="w">         </span><span class="m">0</span>.0.0.0/0<span class="w">            </span><span class="m">0</span>.0.0.0/0<span class="w">            </span>/*<span class="w"> </span>egw:lefvkAAcigCbsdOb<span class="w"> </span>*/<span class="w"> </span>/*<span class="w"> </span>Accept<span class="w"> </span><span class="k">for</span><span class="w"> </span>egress<span class="w"> </span>traffic<span class="w"> </span>from<span class="w"> </span>pod<span class="w"> </span>going<span class="w"> </span>to<span class="w"> </span>EgressTunnel<span class="w"> </span>*/<span class="w"> </span>mark<span class="w"> </span>match<span class="w"> </span>0x26000000
</span><span id="__span-10-19"><a id="__codelineno-10-19" name="__codelineno-10-19" href="#__codelineno-10-19"></a>155K<span class="w"> </span>9378K<span class="w"> </span>KUBE-POSTROUTING<span class="w">        </span><span class="m">0</span><span class="w">    </span>--<span class="w">  </span>*<span class="w">      </span>*<span class="w">         </span><span class="m">0</span>.0.0.0/0<span class="w">            </span><span class="m">0</span>.0.0.0/0<span class="w">            </span>/*<span class="w"> </span>kubernetes<span class="w"> </span>postrouting<span class="w"> </span>rules<span class="w"> </span>*/
</span><span id="__span-10-20"><a id="__codelineno-10-20" name="__codelineno-10-20" href="#__codelineno-10-20"></a><span class="m">0</span><span class="w">        </span><span class="m">0</span><span class="w"> </span>MASQUERADE<span class="w">              </span><span class="m">0</span><span class="w">    </span>--<span class="w">  </span>*<span class="w">      </span>!docker0<span class="w">  </span><span class="m">172</span>.17.0.0/16<span class="w">        </span><span class="m">0</span>.0.0.0/0
</span><span id="__span-10-21"><a id="__codelineno-10-21" name="__codelineno-10-21" href="#__codelineno-10-21"></a>154K<span class="w"> </span>9354K<span class="w"> </span>FLANNEL-POSTRTG<span class="w">         </span><span class="m">0</span><span class="w">    </span>--<span class="w">  </span>*<span class="w">      </span>*<span class="w">         </span><span class="m">0</span>.0.0.0/0<span class="w">            </span><span class="m">0</span>.0.0.0/0<span class="w">            </span>/*<span class="w"> </span>flanneld<span class="w"> </span>masq<span class="w"> </span>*/
</span></code></pre></div>
<p>In addition, on the node where the Pod resides, you can check the routing table using the following command:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a>$<span class="w"> </span>ip<span class="w"> </span>rule
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="m">0</span>:<span class="w">  </span>from<span class="w"> </span>all<span class="w"> </span>lookup<span class="w"> </span><span class="nb">local</span>
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a><span class="m">99</span>:<span class="w"> </span>from<span class="w"> </span>all<span class="w"> </span>fwmark<span class="w"> </span>0x26b7b4e4<span class="w"> </span>lookup<span class="w"> </span><span class="m">649573604</span>
</span><span id="__span-11-4"><a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a><span class="m">32766</span>:<span class="w">  </span>from<span class="w"> </span>all<span class="w"> </span>lookup<span class="w"> </span>main
</span><span id="__span-11-5"><a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a><span class="m">32767</span>:<span class="w">  </span>from<span class="w"> </span>all<span class="w"> </span>lookup<span class="w"> </span>default
</span><span id="__span-11-6"><a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a>
</span><span id="__span-11-7"><a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a>$<span class="w"> </span>ip<span class="w"> </span>r<span class="w"> </span>show<span class="w"> </span>table<span class="w"> </span><span class="m">649573604</span>
</span><span id="__span-11-8"><a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a>default<span class="w"> </span>via<span class="w"> </span><span class="m">192</span>.200.201.40<span class="w"> </span>dev<span class="w"> </span>egress.vxlan
</span><span id="__span-11-9"><a id="__codelineno-11-9" name="__codelineno-11-9" href="#__codelineno-11-9"></a>
</span><span id="__span-11-10"><a id="__codelineno-11-10" name="__codelineno-11-10" href="#__codelineno-11-10"></a>$<span class="w"> </span>ip<span class="w"> </span>r<span class="w"> </span>show<span class="w"> </span>table<span class="w"> </span><span class="m">649573604</span>
</span><span id="__span-11-11"><a id="__codelineno-11-11" name="__codelineno-11-11" href="#__codelineno-11-11"></a>default<span class="w"> </span>via<span class="w"> </span><span class="m">192</span>.200.201.40<span class="w"> </span>dev<span class="w"> </span>egress.vxlan
</span><span id="__span-11-12"><a id="__codelineno-11-12" name="__codelineno-11-12" href="#__codelineno-11-12"></a>
</span><span id="__span-11-13"><a id="__codelineno-11-13" name="__codelineno-11-13" href="#__codelineno-11-13"></a>$<span class="w"> </span>kubectl<span class="w"> </span>get<span class="w"> </span>egt
</span><span id="__span-11-14"><a id="__codelineno-11-14" name="__codelineno-11-14" href="#__codelineno-11-14"></a>NAME<span class="w">    </span>TUNNELMAC<span class="w">           </span>TUNNELIPV4<span class="w">       </span>TUNNELIPV6<span class="w">   </span>MARK<span class="w">         </span>PHASE
</span><span id="__span-11-15"><a id="__codelineno-11-15" name="__codelineno-11-15" href="#__codelineno-11-15"></a>node1<span class="w">   </span><span class="m">66</span>:c5:d6:cc:29:54<span class="w">   </span><span class="m">192</span>.200.142.89<span class="w">                </span>0x2698ee37<span class="w">   </span>Ready
</span><span id="__span-11-16"><a id="__codelineno-11-16" name="__codelineno-11-16" href="#__codelineno-11-16"></a>node2<span class="w">   </span><span class="m">66</span>:66:41:3e:23:6b<span class="w">   </span><span class="m">192</span>.200.201.40<span class="w">                </span>0x26b7b4e4<span class="w">   </span>Ready
</span><span id="__span-11-17"><a id="__codelineno-11-17" name="__codelineno-11-17" href="#__codelineno-11-17"></a>
</span><span id="__span-11-18"><a id="__codelineno-11-18" name="__codelineno-11-18" href="#__codelineno-11-18"></a>$<span class="w"> </span>kubectl<span class="w"> </span>get<span class="w"> </span>egp
</span><span id="__span-11-19"><a id="__codelineno-11-19" name="__codelineno-11-19" href="#__codelineno-11-19"></a>NAME<span class="w">   </span>GATEWAY<span class="w">   </span>IPV4<span class="w">            </span>IPV6<span class="w">   </span>EGRESSNODE
</span><span id="__span-11-20"><a id="__codelineno-11-20" name="__codelineno-11-20" href="#__codelineno-11-20"></a><span class="nb">test</span><span class="w">   </span>default<span class="w">   </span><span class="m">172</span>.16.25.189<span class="w">          </span>node2
</span></code></pre></div>
<p>Traffic that matches will be forwarded through the VXLAN tunnel to the EgressGateway node. As shown in the command output above, traffic marked with <code>0x26b7b4e4</code> will be routed to the <code>649573604</code> routing table, where the default route forwards it via the <code>egress.vxlan</code> interface to the corresponding Egress Node.
If you don’t see the rule for <code>0x26b7b4e4</code>, you can check the logs of the Egress Agent Pod on that node.</p>
<p>For the node where the Egress IP is located, you can verify if the Egress IP is correctly configured using the following command:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a>$<span class="w"> </span>sudo<span class="w"> </span>iptables<span class="w"> </span>-t<span class="w"> </span>nat<span class="w"> </span>-nvL<span class="w"> </span>POSTROUTING
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a>Chain<span class="w"> </span>POSTROUTING<span class="w"> </span><span class="o">(</span>policy<span class="w"> </span>ACCEPT<span class="w"> </span><span class="m">19126</span><span class="w"> </span>packets,<span class="w"> </span>1152K<span class="w"> </span>bytes<span class="o">)</span>
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a>pkts<span class="w"> </span>bytes<span class="w"> </span>target<span class="w">                  </span>prot<span class="w"> </span>opt<span class="w">  </span><span class="k">in</span><span class="w">     </span>out<span class="w">     </span><span class="nb">source</span><span class="w">               </span>destination
</span><span id="__span-12-4"><a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a><span class="m">9858</span><span class="w">  </span>596K<span class="w"> </span>EGRESSGATEWAY-SNAT-EIP<span class="w">  </span><span class="m">0</span><span class="w">    </span>--<span class="w">  </span>*<span class="w">      </span>*<span class="w">        </span><span class="m">0</span>.0.0.0/0<span class="w">            </span><span class="m">0</span>.0.0.0/0<span class="w">            </span>/*<span class="w"> </span>egw:x1tdBi75jif7GCxh<span class="w"> </span>*/<span class="w"> </span>/*<span class="w"> </span>SNAT<span class="w"> </span><span class="k">for</span><span class="w"> </span>egress<span class="w"> </span>traffic<span class="w"> </span>*/
</span><span id="__span-12-5"><a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a><span class="m">2</span><span class="w">      </span><span class="m">244</span><span class="w"> </span>ACCEPT<span class="w">                  </span><span class="m">0</span><span class="w">    </span>--<span class="w">  </span>*<span class="w">      </span>*<span class="w">        </span><span class="m">0</span>.0.0.0/0<span class="w">            </span><span class="m">0</span>.0.0.0/0<span class="w">            </span>/*<span class="w"> </span>egw:lefvkAAcigCbsdOb<span class="w"> </span>*/<span class="w"> </span>/*<span class="w"> </span>Accept<span class="w"> </span><span class="k">for</span><span class="w"> </span>egress<span class="w"> </span>traffic<span class="w"> </span>from<span class="w"> </span>pod<span class="w"> </span>going<span class="w"> </span>to<span class="w"> </span>EgressTunnel<span class="w"> </span>*/<span class="w"> </span>mark<span class="w"> </span>match<span class="w"> </span>0x26000000
</span><span id="__span-12-6"><a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a><span class="m">9905</span><span class="w">  </span>599K<span class="w"> </span>KUBE-POSTROUTING<span class="w">        </span><span class="m">0</span><span class="w">    </span>--<span class="w">  </span>*<span class="w">      </span>*<span class="w">        </span><span class="m">0</span>.0.0.0/0<span class="w">            </span><span class="m">0</span>.0.0.0/0<span class="w">            </span>/*<span class="w"> </span>kubernetes<span class="w"> </span>postrouting<span class="w"> </span>rules<span class="w"> </span>*/
</span><span id="__span-12-7"><a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a><span class="m">0</span><span class="w">        </span><span class="m">0</span><span class="w"> </span>MASQUERADE<span class="w">              </span><span class="m">0</span><span class="w">    </span>--<span class="w">  </span>*<span class="w">      </span>!docker0<span class="w"> </span><span class="m">172</span>.17.0.0/16<span class="w">        </span><span class="m">0</span>.0.0.0/0
</span><span id="__span-12-8"><a id="__codelineno-12-8" name="__codelineno-12-8" href="#__codelineno-12-8"></a><span class="m">9875</span><span class="w">  </span>597K<span class="w"> </span>FLANNEL-POSTRTG<span class="w">         </span><span class="m">0</span><span class="w">    </span>--<span class="w">  </span>*<span class="w">      </span>*<span class="w">        </span><span class="m">0</span>.0.0.0/0<span class="w">            </span><span class="m">0</span>.0.0.0/0<span class="w">            </span>/*<span class="w"> </span>flanneld<span class="w"> </span>masq<span class="w"> </span>*/
</span><span id="__span-12-9"><a id="__codelineno-12-9" name="__codelineno-12-9" href="#__codelineno-12-9"></a>
</span><span id="__span-12-10"><a id="__codelineno-12-10" name="__codelineno-12-10" href="#__codelineno-12-10"></a>$<span class="w"> </span>sudo<span class="w"> </span>iptables<span class="w"> </span>-t<span class="w"> </span>nat<span class="w"> </span>-nvL<span class="w"> </span>EGRESSGATEWAY-SNAT-EIP
</span><span id="__span-12-11"><a id="__codelineno-12-11" name="__codelineno-12-11" href="#__codelineno-12-11"></a>Chain<span class="w"> </span>EGRESSGATEWAY-SNAT-EIP<span class="w"> </span><span class="o">(</span><span class="m">1</span><span class="w"> </span>references<span class="o">)</span>
</span><span id="__span-12-12"><a id="__codelineno-12-12" name="__codelineno-12-12" href="#__codelineno-12-12"></a>pkts<span class="w"> </span>bytes<span class="w"> </span>target<span class="w">     </span>prot<span class="w"> </span>opt<span class="w"> </span><span class="k">in</span><span class="w">     </span>out<span class="w">     </span><span class="nb">source</span><span class="w">               </span>destination
</span><span id="__span-12-13"><a id="__codelineno-12-13" name="__codelineno-12-13" href="#__codelineno-12-13"></a><span class="m">2</span><span class="w">      </span><span class="m">144</span><span class="w">   </span>SNAT<span class="w">        </span><span class="m">0</span><span class="w">  </span>--<span class="w">  </span>*<span class="w">      </span>*<span class="w">      </span><span class="m">0</span>.0.0.0/0<span class="w">            </span><span class="m">0</span>.0.0.0/0<span class="w">            </span>/*<span class="w"> </span>egw:Jv9_F-2cYSllqljc<span class="w"> </span>*/<span class="w"> </span>/*<span class="w"> </span>snat<span class="w"> </span>policy<span class="w"> </span>default-test<span class="w"> </span>*/<span class="w"> </span>match-set<span class="w"> </span>egress-src-v4-738bb014438bdbfe7<span class="w"> </span>src<span class="w"> </span>match-set<span class="w"> </span>egress-dst-v4-738bb014438bdbfe7<span class="w"> </span>dst<span class="w"> </span>ctdir<span class="w"> </span>ORIGINAL<span class="w"> </span>to:172.16.25.189
</span></code></pre></div>
<p>First, the <code>POSTROUTING</code> chain should include the <code>EGRESSGATEWAY-SNAT-EIP</code> rule, and it should appear in the first position.
If you see a SNAT rule in the <code>EGRESSGATEWAY-SNAT-EIP</code> chain and the <code>to:</code> field points to the Egress IP, then it means the Egress IP has been correctly configured. The purpose of this rule is to perform SNAT on the EgressGateway traffic, converting the source IP address to the Egress IP.</p>
<h2 id="5-check-if-the-egress-node-can-access-the-destsubnet-network">5. Check if the Egress Node Can Access the destSubnet Network</h2>
<p>Usually, run the following command inside the Pod to check if it can access the destination subnet and confirm whether the returned source IP is the EgressGateway's Egress IP:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a>curl<span class="w"> </span>dest_subnet_ip:port
</span></code></pre></div>
<p>Similarly, you can run this command on the Egress Node to confirm if it can access the destination subnet. EgressGateway will select the network interface based on routing. You can check which interface is actually used with <code>ip r get dest_subnet_ip</code>.</p>
<h2 id="6-packet-capture-check">6. Packet Capture Check</h2>
<p>You can use tcpdump on both the Pod's node and the Egress IP's node to capture packets and check if the traffic is being forwarded correctly. If the capture shows that traffic is not being forwarded correctly, you can determine whether the node with the Egress IP has received the traffic sent by the Pod.</p>
<p>If the traffic is received but there is no return traffic, and the traffic with the Egress IP as the source IP is being forwarded correctly, it is possible that the host platform is dropping this part of the traffic. Please check the firewall rules of the host platform.</p>
<p>If none of the above steps resolve the issue, please visit our project's issue page, submit your problem, and include your environment information and relevant logs. We will help you resolve the issue as soon as possible.</p>





                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.annotate", "content.tabs.link"], "search": "../../assets/javascripts/workers/search.dfff1995.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.dff1b7c8.min.js"></script>
      
    
  </body>
</html>